#this scenario will be executed if a Pull Request has been approved
name: pull request approved logic

#depends on the target branch one of the following scenarios will be executed:
on:
  pull_request_review:
    types: [submitted]


jobs:
  push_logic:
    runs-on: ubuntu-latest
    steps:
      - name: Global Step 0. Logger
        run: |
          echo -e "--- Step 1. Output global info for the current pipeline ---\n"
          echo "Event is:"
          echo -e "Pull request\n"
          echo "Pull request source branch is:"
          echo ${{ github.event.pull_request.head.ref }}
          echo -e "\nPull request target branch is:"
          echo ${{ github.event.pull_request.base.ref }}
        
          
      - uses: actions/checkout@v3
        with:
          fetch-depth: 0

      #Install SFDX
      - name: Global Step 1. SFDX CLI installation
        run: |
          chmod +x ./build/install_dependencies.sh
          ./build/install_dependencies.sh


#      #Login to the target Salesforce org
#      - name: Global Step 2. Salesforce org login
#        run: |
#          chmod +x ./build/login_to_SF_org.sh
#          ./build/login_to_SF_org.sh
#        env:
#            TARGET_BRANCH_NAME: ${{ github.event.pull_request.base.ref }}

      
      #Deploy metadata to the target Salesforce org
#      - name: Deploy metadata to Salesforce org
#        run: |
#          chmod +x ./build/deploy_metadata_to_sf_org.sh
#          ./build/deploy_metadata_to_sf_org.sh
#        env:
#            SOURCE_BRANCH_NAME: ${{ github.event.pull_request.head.ref }}
#            TARGET_BRANCH_NAME: ${{ github.event.pull_request.base.ref }}